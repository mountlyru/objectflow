# Пример: Загрузка документа «Версия коммерческого договора» со справочником «Договоры контрагентов»

Пошаговое руководство по загрузке данных из Excel-файла в документ **«Версия соглашения (коммерческий договор)»** (1С:ERP / 1С:Комплексная автоматизация).

Этот пример демонстрирует **продвинутую загрузку**: документ и связанный с ним элемент справочника «Договоры контрагентов» создаются **за один проход** с помощью произвольного кода, записи объекта в коде и оборачивания всего процесса в **единую транзакцию**.

---

## Содержание

1. [Общая схема загрузки](#1-общая-схема-загрузки)
2. [Подготовка Excel-файла](#2-подготовка-excel-файла)
3. [Выбор типа объекта и загрузка файла](#3-выбор-типа-объекта-и-загрузка-файла)
4. [Настройка маппинга реквизитов документа](#4-настройка-маппинга-реквизитов-документа)
5. [Произвольный код: создание справочника «Договоры контрагентов»](#5-произвольный-код-создание-справочника-договоры-контрагентов)
6. [Настройка параметров загрузки](#6-настройка-параметров-загрузки)
7. [Запуск загрузки и проверка результатов](#7-запуск-загрузки-и-проверка-результатов)
8. [JSON-конфигурация настроек](#8-json-конфигурация-настроек)

---

## 1. Общая схема загрузки

В 1С:ERP документ «Версия коммерческого договора» связан со справочником «Договоры контрагентов». Обычно это требует двух отдельных загрузок. Но в данном примере мы используем **произвольный код**, чтобы в момент записи документа автоматически создать элемент справочника и привязать его.

**Принцип работы:**

```
┌─────────────────────────────────────┐
│  Excel-файл «Договоры.xlsx»         │
│  (единый источник данных)           │
└──────────────────┬──────────────────┘
                   │
                   ▼
┌──────────────────────────────────────────────────────┐
│           Единая транзакция                          │
│                                                      │
│  1. Маппинг реквизитов документа                     │
│     (из файла, значениями, предопределенные)         │
│                                                      │
│  2. Произвольный код (ПередЗаписью):                 │
│     ┌───────────────────────────────────────────┐    │
│     │  Создать элемент справочника              │    │
│     │  «ДоговорыКонтрагентов»                   │    │
│     │  Заполнить его реквизиты из документа     │    │
│     │  Записать справочник                      │    │
│     │  Присвоить ссылку реквизиту документа     │    │
│     └───────────────────────────────────────────┘    │
│                                                      │
│  3. Запись документа (в коде, не автоматически)      │
│                                                      │
│  Если ошибка → откат ВСЕЙ транзакции                 │
└──────────────────────────────────────────────────────┘
```

**Преимущества подхода:**
- **Один проход** — не нужно запускать загрузку дважды
- **Транзакция** — если что-то пойдет не так, откатятся и документ, и справочник
- **Запись в коде** — полный контроль над порядком записи объектов

---

## 2. Подготовка Excel-файла

Подготовьте файл `Договоры.xlsx` со следующей структурой (19 колонок):

| Дата | Номер | БанковскийСчет | БанковскийСчетКонтрагента | ВидДоговораУХ | ВидСоглашения | ГосударственныйКонтракт | ДатаНачалаДействия | ДатаОкончанияДействия | ВалютаВзаиморасчетов | Контрагент | ЗаполненыРеквизитыУчетаСМСП | ЗапретПлатежаВПрочихВалютах | Организация | Сумма | ОсновнаяВалютаПлатежей | ОсновнойПроект | ОсновнойЦФО | Ответственный |
|------|-------|----------------|---------------------------|---------------|---------------|--------------------------|--------------------|-----------------------|----------------------|------------|------------------------------|------------------------------|-------------|-------|------------------------|----------------|-------------|---------------|
| 27.09.2018 17:29:19 | r434563456 | | | С поставщиком | Договор с условием | | | | руб. | Юникредит банк | Да | Да | Трансформатор | 0 | руб. | | | Орлов Александр Владимирович |
| 02.11.2018 18:00:57 | ааа | | АКБ "СОЮЗ" (ОАО) (RUB) | С покупателем | Договор с условием | | | | руб. | Мастер- Холод | Да | Да | Транслятор | 0 | руб. | | | Орлов Александр Владимирович |
| 01.01.2018 0:00:00 | ггг | | АКБ "СОЮЗ" (ОАО) (RUB) | С покупателем | Договор с условием | | 01.01.2018 | 31.12.2018 | руб. | Мастер- Холод | Да | Да | Транслятор | 0 | руб. | | | Орлов Александр Владимирович |
| 02.11.2018 18:01:38 | 654 | | АКБ "СОЮЗ" (ОАО) (RUB) | С покупателем | Договор с условием | | | | руб. | Мастер- Холод | Да | Да | Транслятор | 10000 | руб. | | | Орлов Александр Владимирович |
| 15.11.2018 15:17:05 | 2 | МАСТЕР-БАНК, Стройснаб (RUB) | АО ЮНИКРЕДИТ БАНК (RUB) | С поставщиком | Договор с условием | | | | руб. | Юникредит банк | Да | Да | Стройснаб | 0 | руб. | | | Орлов Александр Владимирович |

> **Важно:** Данные начинаются со **2-й строки** (первая строка — заголовки). Файл содержит **10 строк** данных.

**Ключевые колонки:**
- **Дата** (колонка A) — дата и время создания договора
- **Номер** (колонка B) — номер договора, используется как наименование для печати
- **Контрагент** (колонка K) — наименование контрагента
- **Организация** (колонка N) — наименование организации
- **ВидДоговораУХ** (колонка E) — вид договора (С поставщиком / С покупателем)
- **ВалютаВзаиморасчетов** (колонка J) — валюта расчетов
- **БанковскийСчет** (колонка C) — банковский счет организации
- **БанковскийСчетКонтрагента** (колонка D) — банковский счет контрагента
- 
---

## 3. Выбор типа объекта и загрузка файла

1. Откройте веб-интерфейс ObjectFlow
2. Загрузите файл `Договоры.xlsx`
3. В выпадающем списке **«Тип объекта»** выберите: **Документ.ВерсияСоглашенияКоммерческийДоговор**

<img width="686" height="257" alt="image" src="https://github.com/user-attachments/assets/64e75eb3-1494-4f08-bd2b-d0f9f1245d63" />

---

## 4. Настройка маппинга реквизитов документа

### 4.1. Реквизиты из файла — простые типы

| Реквизит | Колонка файла | Тип данных | Описание |
|----------|---------------|------------|----------|
| Дата | Дата (колонка 0) | Дата | Дата и время создания |
| ДатаНачалаДействия | ДатаНачалаДействия (колонка 7) | Дата | Начало действия договора |
| ДатаОкончанияДействия | ДатаОкончанияДействия (колонка 8) | Дата | Окончание действия договора |
| Сумма | Сумма (колонка 14) | Число(15,2) | Сумма договора |
| ЗаполненыРеквизитыУчетаСМСП | ЗаполненыРеквизитыУчетаСМСП (колонка 11) | Булево | — |
| ЗапретПлатежаВПрочихВалютах | ЗапретПлатежаВПрочихВалютах (колонка 12) | Булево | — |
| НаименованиеДляПечати | Номер (колонка 1) | Строка(150) | Номер договора для печатных форм |

<img width="762" height="626" alt="image" src="https://github.com/user-attachments/assets/80df616d-5aa7-4422-a18e-a38c0b2ca3dd" />

### 4.2. Реквизиты из файла — ссылочные типы (поиск по наименованию)

| Реквизит | Колонка файла | Тип ссылки | Поиск по |
|----------|---------------|------------|----------|
| ВидСоглашения | ВидСоглашения (колонка 5) | ПеречислениеСсылка.ВидыСоглашений | Наименование |
| Организация | Организация (колонка 13) | СправочникСсылка.Организации | Наименование |
| Контрагент | Контрагент (колонка 10) | СправочникСсылка.Контрагенты | Наименование |
| ВидДоговораУХ | ВидДоговораУХ (колонка 4) | СправочникСсылка.ВидыДоговоровКонтрагентовУХ | Наименование |
| ВалютаВзаиморасчетов | ВалютаВзаиморасчетов (колонка 9) | СправочникСсылка.Валюты | Наименование |
| ОсновнаяВалютаПлатежей | ОсновнаяВалютаПлатежей (колонка 15) | СправочникСсылка.Валюты | Наименование |
| ГосударственныйКонтракт | ГосударственныйКонтракт (колонка 6) | СправочникСсылка.ГосударственныеКонтракты | Наименование |
| ОсновнойПроект | ОсновнойПроект (колонка 16) | СправочникСсылка.Проекты | Наименование |
| ОсновнойЦФО | ОсновнойЦФО (колонка 17) | СправочникСсылка.Организации | Наименование |
| Ответственный | Ответственный (колонка 18) | СправочникСсылка.Пользователи | Наименование |

<img width="746" height="787" alt="image" src="https://github.com/user-attachments/assets/6e1f3353-6e41-41da-9e6e-ef739671160c" />

### 4.3. Реквизиты с составным поиском (по нескольким свойствам)

#### Банковский счет организации

Поиск в справочнике **БанковскиеСчетаОрганизаций** по двум свойствам:

| Свойство поиска | Источник | Значение |
|-----------------|----------|----------|
| Владелец | Из маппинга (Организация, маппинг №1) | Ссылка на организацию |
| НомерСчета | Из файла (колонка 2) | Текстовое значение |

#### Банковский счет контрагента

Поиск в справочнике **БанковскиеСчетаКонтрагентов** по двум свойствам:

| Свойство поиска | Источник | Значение |
|-----------------|----------|----------|
| Владелец | Из маппинга (Контрагент, маппинг №2) | Ссылка на контрагента |
| НомерСчета | Из файла (колонка 3) | Текстовое значение |

> Составной поиск гарантирует, что банковский счет принадлежит именно нужной организации или контрагенту.

<!-- SCREENSHOT: Скриншот настройки составного поиска -->
> ![Составной поиск банковских счетов](screenshots/dogovor-04-composite-search.png)

### 4.4. Реквизиты, заполняемые фиксированным значением

| Реквизит | Значение | Описание |
|----------|----------|----------|
| КратностьПлатежа | `1` | Кратность валюты платежа |
| НДСПоСтавкам4и2 | `Ложь` | Не использовать ставки 4% и 2% |

### 4.5. Реквизиты, заполняемые предопределенным значением

| Реквизит | Предопределенное значение | Описание |
|----------|---------------------------|----------|
| СпособРасчетаКоличестваДней | Календарные дни | Способ расчета дней в периоде |
| ВариантКурсаДоговораУХ | Переменный | Курс валюты в договоре |

<!-- SCREENSHOT: Скриншот полного маппинга документа -->
> ![Полный маппинг документа](screenshots/dogovor-05-full-mapping.png)

---

## 5. Произвольный код: создание справочника «Договоры контрагентов»

Это **ключевая особенность** данного примера. В разделе **«Произвольный код»** настройки загрузки добавляется алгоритм, который:

1. Создает новый элемент справочника «ДоговорыКонтрагентов»
2. Заполняет его реквизиты из уже заполненного документа
3. Записывает справочник
4. Привязывает ссылку на созданный договор к документу
5. Записывает сам документ

### Код алгоритма (событие «ПередЗаписью»)

```1c
// Доступные переменные:
// ЗагружаемыйОбъект — документ ВерсияСоглашенияКоммерческийДоговор
// СтрокаДанных — текущая строка из Excel-файла
// Отказ — установить Истина для отмены записи строки

// 1. Создаем новый элемент справочника «Договоры контрагентов»
НовыйДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();

// 2. Заполняем реквизиты из документа
НовыйДоговор.Наименование       = ЗагружаемыйОбъект.НаименованиеДляПечати;
НовыйДоговор.Владелец            = ЗагружаемыйОбъект.Контрагент;
НовыйДоговор.Организация         = ЗагружаемыйОбъект.Организация;
НовыйДоговор.ВидДоговора         = ЗагружаемыйОбъект.ВидДоговораУХ;
НовыйДоговор.Дата                = ЗагружаемыйОбъект.Дата;
НовыйДоговор.ВалютаВзаиморасчетов = ЗагружаемыйОбъект.ВалютаВзаиморасчетов;

// 3. Записываем справочник
НовыйДоговор.Записать();

// 4. Привязываем созданный договор к документу
ЗагружаемыйОбъект.ДоговорКонтрагента = НовыйДоговор.Ссылка;

// 5. Записываем документ
ЗагружаемыйОбъект.Записать();
```

### Как это работает

```
Для каждой строки Excel:
  ┌─────────────────────────────────────────────────┐
  │  Начало транзакции                               │
  │                                                   │
  │  1. Loader1C заполняет реквизиты документа        │
  │     по маппингу (из файла, значениями и т.д.)     │
  │                                                   │
  │  2. Вызывается произвольный код «ПередЗаписью»:   │
  │     • Создается элемент ДоговорыКонтрагентов      │
  │     • Реквизиты копируются из документа            │
  │     • Справочник записывается                      │
  │     • Ссылка присваивается документу               │
  │     • Документ записывается                        │
  │                                                   │
  │  3. Loader1C НЕ записывает объект автоматически    │
  │     (режим записи = «в коде»)                      │
  │                                                   │
  │  Фиксация транзакции                              │
  └─────────────────────────────────────────────────┘
```

> **Важно:** Режим записи объекта установлен в **«В коде»** (`objectWriteMode: "code"`). Это означает, что Loader1C **не записывает** документ автоматически после заполнения реквизитов — запись выполняется внутри произвольного кода вызовом `ЗагружаемыйОбъект.Записать()`.

<!-- SCREENSHOT: Скриншот настройки произвольного кода -->
> ![Произвольный код](screenshots/dogovor-06-custom-algorithm.png)

### Зачем записывать в коде?

В обычном режиме Loader1C сначала заполняет реквизиты, а потом автоматически записывает объект. Но в нашем случае нужно:

1. **До записи документа** — создать и записать элемент справочника
2. **Присвоить ссылку** справочника реквизиту документа
3. **Только потом** — записать документ

Если бы запись была автоматической, документ записался бы **без** ссылки на договор, потому что справочник ещё не существовал бы в момент записи.

---

## 6. Настройка параметров загрузки

| Параметр | Значение | Описание |
|----------|----------|----------|
| Группировка строк | Нет | Каждая строка — отдельный документ |
| Лист Excel | Первый лист (индекс 0) | — |
| Начальная строка | 2 | Пропуск строки заголовков |
| Режим обновления | Обновление | Если документ существует — обновить |
| **Режим записи** | **В коде** | Запись объекта выполняется в произвольном коде |
| Обязательные поля | Пропускать | Строки с незаполненными обязательными полями пропускаются |
| **Использовать транзакцию** | **Да** | Все объекты записываются в одной транзакции |
| Режим разработчика | Нет | — |

### Почему «В коде»?

Режим записи **«В коде»** (`objectWriteMode: "code"`) означает, что Loader1C заполняет реквизиты документа по маппингу, но **не вызывает** `Записать()` автоматически. Вместо этого запись происходит внутри произвольного кода, где вы полностью контролируете порядок операций.

### Почему транзакция?

Включение **транзакции** (`useTransaction: true`) гарантирует атомарность: если при создании справочника или записи документа произойдет ошибка, **оба объекта** будут откатаны. Без транзакции может возникнуть ситуация, когда справочник создан, а документ — нет (или наоборот).

<!-- SCREENSHOT: Скриншот настройки параметров загрузки -->
> ![Параметры загрузки](screenshots/dogovor-07-load-settings.png)

---

## 7. Запуск загрузки и проверка результатов

### Порядок действий

1. Убедитесь, что все маппинги настроены корректно
2. Убедитесь, что произвольный код добавлен в раздел **«Произвольный код»**
3. Убедитесь, что режим записи — **«В коде»**, транзакция — **Да**
4. Нажмите кнопку **«Загрузить»**
5. Проверьте лог загрузки

<!-- SCREENSHOT: Скриншот процесса загрузки -->
> ![Процесс загрузки](screenshots/dogovor-08-loading-process.png)

### Ожидаемый результат

После загрузки для каждой строки Excel будут созданы **два объекта**:

**1. Элемент справочника «Договоры контрагентов»:**

| Наименование | Контрагент | Организация | Вид договора |
|-------------|------------|-------------|--------------|
| r434563456 | Юникредит банк | Трансформатор | С поставщиком |
| ааа | Мастер- Холод | Транслятор | С покупателем |
| ггг | Мастер- Холод | Транслятор | С покупателем |
| 654 | Мастер- Холод | Транслятор | С покупателем |
| 2 | Юникредит банк | Стройснаб | С поставщиком |

**2. Документ «Версия коммерческого договора»** (пример одного):
- Дата: 27.09.2018 17:29:19
- Наименование для печати: r434563456
- Организация: Трансформатор
- Контрагент: Юникредит банк
- **Договор контрагента: r434563456** (ссылка на созданный справочник)
- Вид договора: С поставщиком
- Вид соглашения: Договор с условием
- Валюта взаиморасчетов: руб.
- Сумма: 0
- Ответственный: Орлов Александр Владимирович

<!-- SCREENSHOT: Скриншот результата — созданные объекты в 1С -->
> ![Результат в 1С](screenshots/dogovor-09-result-in-1c.png)

---

## 8. JSON-конфигурация настроек

Ниже приведен полный JSON-файл настроек, который можно импортировать в Loader1C.

Обратите внимание на ключевые отличия от стандартной загрузки:
- `loadSettings.useTransaction: true` — загрузка в транзакции
- `loadSettings.objectWriteMode: "code"` — запись объекта в произвольном коде
- `loadSettings.customAlgorithms` — содержит произвольный код создания справочника

<details>
<summary>Развернуть JSON-конфигурацию</summary>

```json
{
  "version": "1.0",
  "timestamp": "2026-02-13T08:29:19.668Z",
  "objectType": {
    "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
    "name": "ВерсияСоглашенияКоммерческийДоговор",
    "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
  },
  "fileStructure": {
    "columns": [
      {
        "dataType": "Строка",
        "index": 0,
        "name": "Дата",
        "sampleValues": [
          "27.09.2018 17:29:19",
          "02.11.2018 18:00:57",
          "01.01.2018 0:00:00",
          "02.11.2018 18:01:38",
          "15.11.2018 15:17:05"
        ]
      },
      {
        "dataType": "Строка",
        "index": 1,
        "name": "Номер",
        "sampleValues": [
          "r434563456",
          "ааа",
          "ггг",
          "654",
          "2"
        ]
      },
      {
        "dataType": "Число",
        "index": 2,
        "name": "БанковскийСчет",
        "sampleValues": [
          "nan",
          "nan",
          "nan",
          "nan",
          "МАСТЕР-БАНК, Стройснаб (RUB)"
        ]
      },
      {
        "dataType": "Строка",
        "index": 3,
        "name": "БанковскийСчетКонтрагента",
        "sampleValues": [
          "nan",
          "АКБ \"СОЮЗ\" (ОАО) (RUB)",
          "АКБ \"СОЮЗ\" (ОАО) (RUB)",
          "АКБ \"СОЮЗ\" (ОАО) (RUB)",
          "АО ЮНИКРЕДИТ БАНК (RUB)"
        ]
      },
      {
        "dataType": "Строка",
        "index": 4,
        "name": "ВидДоговораУХ",
        "sampleValues": [
          "С поставщиком",
          "С покупателем",
          "С покупателем",
          "С покупателем",
          "С поставщиком"
        ]
      },
      {
        "dataType": "Строка",
        "index": 5,
        "name": "ВидСоглашения",
        "sampleValues": [
          "Договор с условием",
          "Договор с условием",
          "Договор с условием",
          "Договор с условием",
          "Договор с условием"
        ]
      },
      {
        "dataType": "Число",
        "index": 6,
        "name": "ГосударственныйКонтракт",
        "sampleValues": [
          "nan",
          "nan",
          "nan",
          "nan",
          "nan"
        ]
      },
      {
        "dataType": "Строка",
        "index": 7,
        "name": "ДатаНачалаДействия",
        "sampleValues": [
          "nan",
          "nan",
          "01.01.2018",
          "nan",
          "nan"
        ]
      },
      {
        "dataType": "Строка",
        "index": 8,
        "name": "ДатаОкончанияДействия",
        "sampleValues": [
          "nan",
          "nan",
          "31.12.2018",
          "nan",
          "nan"
        ]
      },
      {
        "dataType": "Строка",
        "index": 9,
        "name": "ВалютаВзаиморасчетов",
        "sampleValues": [
          "руб.",
          "руб.",
          "руб.",
          "руб.",
          "руб."
        ]
      },
      {
        "dataType": "Строка",
        "index": 10,
        "name": "Контрагент",
        "sampleValues": [
          "Юникредит банк",
          "Мастер- Холод",
          "Мастер- Холод",
          "Мастер- Холод",
          "Юникредит банк"
        ]
      },
      {
        "dataType": "Булево",
        "index": 11,
        "name": "ЗаполненыРеквизитыУчетаСМСП",
        "sampleValues": [
          "Да",
          "Да",
          "Да",
          "Да",
          "Да"
        ]
      },
      {
        "dataType": "Булево",
        "index": 12,
        "name": "ЗапретПлатежаВПрочихВалютах",
        "sampleValues": [
          "Да",
          "Да",
          "Да",
          "Да",
          "Да"
        ]
      },
      {
        "dataType": "Строка",
        "index": 13,
        "name": "Организация",
        "sampleValues": [
          "Трансформатор",
          "Транслятор",
          "Транслятор",
          "Транслятор",
          "Стройснаб"
        ]
      },
      {
        "dataType": "Число (целое)",
        "index": 14,
        "name": "Сумма",
        "sampleValues": [
          "0",
          "0",
          "0",
          "10000",
          "0"
        ]
      },
      {
        "dataType": "Строка",
        "index": 15,
        "name": "ОсновнаяВалютаПлатежей",
        "sampleValues": [
          "руб.",
          "руб.",
          "руб.",
          "руб.",
          "руб."
        ]
      },
      {
        "dataType": "Число",
        "index": 16,
        "name": "ОсновнойПроект",
        "sampleValues": [
          "nan",
          "nan",
          "nan",
          "nan",
          "nan"
        ]
      },
      {
        "dataType": "Число",
        "index": 17,
        "name": "ОсновнойЦФО",
        "sampleValues": [
          "nan",
          "nan",
          "nan",
          "nan",
          "nan"
        ]
      },
      {
        "dataType": "Строка",
        "index": 18,
        "name": "Ответственный",
        "sampleValues": [
          "Орлов Александр Владимирович",
          "Орлов Александр Владимирович",
          "Орлов Александр Владимирович",
          "Орлов Александр Владимирович",
          "Орлов Александр Владимирович"
        ]
      }
    ],
    "fileName": "Договоры.xlsx",
    "fileType": "excel",
    "rowCount": 10
  },
  "mappings": [
    {
      "dataType": "ПеречислениеСсылка.ВидыСоглашений",
      "fileColumn": "ВидСоглашения",
      "fileColumnIndex": 5,
      "fillMethod": "fromFile",
      "fullType": "ПеречислениеСсылка.ВидыСоглашений",
      "isRequired": false,
      "objectProperty": "ВидСоглашения",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ВидСоглашения",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "5"
        }
      ],
      "searchOrder": 0,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "ПеречислениеСсылка.ВидыСоглашений",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Организации",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Организации",
      "isRequired": false,
      "objectProperty": "Организация",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.Организация",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "13"
        }
      ],
      "searchOrder": 1,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Организации",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Контрагенты",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Контрагенты",
      "isRequired": false,
      "objectProperty": "Контрагент",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.Контрагент",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "10"
        }
      ],
      "searchOrder": 2,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Контрагенты",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.ВидыДоговоровКонтрагентовУХ",
      "fileColumn": "ВидДоговораУХ",
      "fileColumnIndex": 4,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.ВидыДоговоровКонтрагентовУХ",
      "isRequired": false,
      "objectProperty": "ВидДоговораУХ",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ВидДоговораУХ",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "4"
        }
      ],
      "searchOrder": 3,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.ВидыДоговоровКонтрагентовУХ",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.БанковскиеСчетаОрганизаций",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.БанковскиеСчетаОрганизаций",
      "isRequired": false,
      "objectProperty": "БанковскийСчет",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.БанковскийСчет",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Владелец",
          "propertyType": "СправочникСсылка.Организации",
          "sourceType": "mapping",
          "sourceValue": "1"
        },
        {
          "propertyName": "НомерСчета",
          "propertyType": "Строка(34",
          "sourceType": "file",
          "sourceValue": "2"
        }
      ],
      "searchOrder": 4,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.БанковскиеСчетаОрганизаций",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Дата",
      "fileColumn": "Дата",
      "fileColumnIndex": 0,
      "fillMethod": "fromFile",
      "fullType": "Дата",
      "isRequired": false,
      "objectProperty": "Дата",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.Дата",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 5,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Дата",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.ГосударственныеКонтракты",
      "fileColumn": "ГосударственныйКонтракт",
      "fileColumnIndex": 6,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.ГосударственныеКонтракты",
      "isRequired": false,
      "objectProperty": "ГосударственныйКонтракт",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ГосударственныйКонтракт",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "6"
        }
      ],
      "searchOrder": 6,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.ГосударственныеКонтракты",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Дата",
      "fileColumn": "ДатаНачалаДействия",
      "fileColumnIndex": 7,
      "fillMethod": "fromFile",
      "fullType": "Дата",
      "isRequired": false,
      "objectProperty": "ДатаНачалаДействия",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ДатаНачалаДействия",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 7,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Дата",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Дата",
      "fileColumn": "ДатаОкончанияДействия",
      "fileColumnIndex": 8,
      "fillMethod": "fromFile",
      "fullType": "Дата",
      "isRequired": false,
      "objectProperty": "ДатаОкончанияДействия",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ДатаОкончанияДействия",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 8,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Дата",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.БанковскиеСчетаКонтрагентов",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.БанковскиеСчетаКонтрагентов",
      "isRequired": false,
      "objectProperty": "БанковскийСчетКонтрагента",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.БанковскийСчетКонтрагента",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Владелец",
          "propertyType": "СправочникСсылка.Контрагенты",
          "sourceType": "mapping",
          "sourceValue": "2"
        },
        {
          "propertyName": "НомерСчета",
          "propertyType": "Строка(34",
          "sourceType": "file",
          "sourceValue": "3"
        }
      ],
      "searchOrder": 9,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.БанковскиеСчетаКонтрагентов",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Валюты",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Валюты",
      "isRequired": false,
      "objectProperty": "ВалютаВзаиморасчетов",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ВалютаВзаиморасчетов",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "9"
        }
      ],
      "searchOrder": 10,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Валюты",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Булево",
      "fileColumn": "ЗаполненыРеквизитыУчетаСМСП",
      "fileColumnIndex": 11,
      "fillMethod": "fromFile",
      "fullType": "Булево",
      "isRequired": false,
      "objectProperty": "ЗаполненыРеквизитыУчетаСМСП",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ЗаполненыРеквизитыУчетаСМСП",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 11,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Булево",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Булево",
      "fileColumn": "ЗапретПлатежаВПрочихВалютах",
      "fileColumnIndex": 12,
      "fillMethod": "fromFile",
      "fullType": "Булево",
      "isRequired": false,
      "objectProperty": "ЗапретПлатежаВПрочихВалютах",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ЗапретПлатежаВПрочихВалютах",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 12,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Булево",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Число",
      "fileColumn": "Сумма",
      "fileColumnIndex": 14,
      "fillMethod": "fromFile",
      "fullType": "Число(15,2)",
      "isRequired": false,
      "objectProperty": "Сумма",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.Сумма",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 13,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Число",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Валюты",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Валюты",
      "isRequired": false,
      "objectProperty": "ОсновнаяВалютаПлатежей",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ОсновнаяВалютаПлатежей",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "15"
        }
      ],
      "searchOrder": 14,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Валюты",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Проекты",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Проекты",
      "isRequired": false,
      "objectProperty": "ОсновнойПроект",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ОсновнойПроект",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "16"
        }
      ],
      "searchOrder": 15,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Проекты",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Организации",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Организации",
      "isRequired": false,
      "objectProperty": "ОсновнойЦФО",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ОсновнойЦФО",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "17"
        }
      ],
      "searchOrder": 16,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Организации",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "СправочникСсылка.Пользователи",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "fromFile",
      "fullType": "СправочникСсылка.Пользователи",
      "isRequired": false,
      "objectProperty": "Ответственный",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.Ответственный",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": "byProperty",
      "referenceProperties": [
        {
          "propertyName": "Наименование",
          "propertyType": "Строка",
          "sourceType": "file",
          "sourceValue": "18"
        }
      ],
      "searchOrder": 17,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "СправочникСсылка.Пользователи",
        "message": ""
      },
      "warnings": []
    },
    {
      "dataType": "Число",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "byValue",
      "fillValue": "1",
      "isPredefined": false,
      "isRequired": false,
      "objectProperty": "КратностьПлатежа",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.КратностьПлатежа",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "predefinedValue": null,
      "referenceMethod": null,
      "searchByGuid": false,
      "searchOrder": 18,
      "tablePart": null,
      "validation": {
        "compatibility": "good",
        "expectedType": "Число",
        "message": "Заполнение значением"
      },
      "valueMethod": "predefined",
      "warnings": []
    },
    {
      "dataType": "Булево",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "byValue",
      "fillValue": "false",
      "isPredefined": false,
      "isRequired": false,
      "objectProperty": "НДСПоСтавкам4и2",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.НДСПоСтавкам4и2",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "predefinedValue": null,
      "referenceMethod": null,
      "searchByGuid": false,
      "searchOrder": 19,
      "tablePart": null,
      "validation": {
        "compatibility": "good",
        "expectedType": "Булево",
        "message": "Заполнение значением"
      },
      "valueMethod": "predefined",
      "warnings": []
    },
    {
      "dataType": "ПеречислениеСсылка.СпособыРасчетаКоличестваДнейВПериоде",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "byValue",
      "fillValue": "85d58ed4-57d8-4b93-9365-d632e006773d",
      "isPredefined": true,
      "isRequired": false,
      "objectProperty": "СпособРасчетаКоличестваДней",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.СпособРасчетаКоличестваДней",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "predefinedValue": {
        "description": "ПоКалендарнымДням",
        "displayName": "Календарные дни",
        "name": "",
        "ref": "85d58ed4-57d8-4b93-9365-d632e006773d",
        "synonym": "Календарные дни"
      },
      "referenceMethod": null,
      "searchByGuid": false,
      "searchOrder": 20,
      "tablePart": null,
      "validation": {
        "compatibility": "good",
        "expectedType": "ПеречислениеСсылка.СпособыРасчетаКоличестваДнейВПериоде",
        "message": "Заполнение предопределенным значением"
      },
      "valueMethod": "predefined",
      "warnings": []
    },
    {
      "dataType": "ПеречислениеСсылка.ВариантыКурсаДоговора",
      "fileColumn": null,
      "fileColumnIndex": null,
      "fillMethod": "byValue",
      "fillValue": "d0296ada-4cea-4aa2-9d76-c7dc1a9862e6",
      "isPredefined": true,
      "isRequired": false,
      "objectProperty": "ВариантКурсаДоговораУХ",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.ВариантКурсаДоговораУХ",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "predefinedValue": {
        "description": "Переменный",
        "displayName": "Переменный",
        "name": "",
        "ref": "d0296ada-4cea-4aa2-9d76-c7dc1a9862e6",
        "synonym": "Переменный"
      },
      "referenceMethod": null,
      "searchByGuid": false,
      "searchOrder": 21,
      "tablePart": null,
      "validation": {
        "compatibility": "good",
        "expectedType": "ПеречислениеСсылка.ВариантыКурсаДоговора",
        "message": "Заполнение предопределенным значением"
      },
      "valueMethod": "predefined",
      "warnings": []
    },
    {
      "dataType": "Строка",
      "fileColumn": "Номер",
      "fileColumnIndex": 1,
      "fillMethod": "fromFile",
      "fullType": "Строка(150)",
      "isRequired": false,
      "objectProperty": "НаименованиеДляПечати",
      "objectPropertyFullPath": "ВерсияСоглашенияКоммерческийДоговор.НаименованиеДляПечати",
      "parentObject": {
        "fullname": "Документ.ВерсияСоглашенияКоммерческийДоговор",
        "name": "ВерсияСоглашенияКоммерческийДоговор",
        "ref": "0620cb70-6285-4d6c-90ac-06a82963e144"
      },
      "referenceMethod": null,
      "referenceProperties": [],
      "searchOrder": 22,
      "tablePart": null,
      "validation": {
        "compatibility": "success",
        "expectedType": "Строка",
        "message": ""
      },
      "warnings": []
    }
  ],
  "groupingColumn": null,
  "excelSettings": {
    "sheetIndex": 0,
    "startRow": 2
  },
  "loadSettings": {
    "developerMode": false,
    "useTransaction": true,
    "objectUpdateMode": "update",
    "requiredFieldAction": "skip",
    "objectWriteMode": "code",
    "customAlgorithms": [
      {
        "event": "ПередЗаписью",
        "code": "// Создаем элемент справочника «Договоры контрагентов»\nНовыйДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();\n\n// Заполняем реквизиты из документа\nНовыйДоговор.Наименование = ЗагружаемыйОбъект.НаименованиеДляПечати;\nНовыйДоговор.Владелец = ЗагружаемыйОбъект.Контрагент;\nНовыйДоговор.Организация = ЗагружаемыйОбъект.Организация;\nНовыйДоговор.ВидДоговора = ЗагружаемыйОбъект.ВидДоговораУХ;\nНовыйДоговор.Дата = ЗагружаемыйОбъект.Дата;\nНовыйДоговор.ВалютаВзаиморасчетов = ЗагружаемыйОбъект.ВалютаВзаиморасчетов;\n\n// Записываем справочник\nНовыйДоговор.Записать();\n\n// Привязываем созданный договор к документу\nЗагружаемыйОбъект.ДоговорКонтрагента = НовыйДоговор.Ссылка;\n\n// Записываем документ\nЗагружаемыйОбъект.Записать();"
      }
    ],
    "modifySearchProperties": []
  }
}
```

</details>

---

## Особенности данного примера

### Загрузка за один проход с произвольным кодом

В отличие от двухэтапного подхода, здесь **не нужно** запускать загрузку дважды. Произвольный код в событии **«ПередЗаписью»** создает элемент справочника и привязывает его к документу прямо в процессе загрузки.

### Запись объекта в коде

Режим `objectWriteMode: "code"` отключает автоматическую запись документа после заполнения реквизитов. Это позволяет:
- Создать и записать зависимый объект (справочник) **до** записи документа
- Присвоить ссылку на справочник реквизиту документа
- Записать документ в нужный момент

### Единая транзакция

Параметр `useTransaction: true` оборачивает **всю** загрузку в одну транзакцию. Если при обработке любой строки произойдет ошибка:
- Откатятся **все** созданные справочники
- Откатятся **все** созданные документы
- База данных вернется в исходное состояние

Это гарантирует целостность данных: не может возникнуть ситуация, когда часть договоров загружена, а часть — нет.

### Составной поиск банковских счетов

Банковские счета ищутся по **двум свойствам**: номеру счета из файла и владельцу из другого маппинга:

```
БанковскийСчет организации:
  Владелец = маппинг «Организация» (№1)
  НомерСчета = колонка «БанковскийСчет» (№2) из файла

БанковскийСчет контрагента:
  Владелец = маппинг «Контрагент» (№2)
  НомерСчета = колонка «БанковскийСчетКонтрагента» (№3) из файла
```

---

## Частые вопросы

### Чем отличается режим записи «В коде» от «Автоматический»?

| | Автоматический | В коде |
|---|---|---|
| Кто записывает объект | Loader1C | Ваш произвольный код |
| Когда вызывается `Записать()` | После заполнения всех реквизитов | Когда вы решите |
| Можно создать другие объекты до записи | Нет | Да |
| Подходит для связанных объектов | Нет | Да |

### Что будет, если произвольный код вызовет ошибку?

При включенной транзакции (`useTransaction: true`) все изменения откатятся. Если транзакция выключена — уже записанные объекты останутся в базе, а текущий и последующие будут пропущены с ошибкой в логе.

### Можно ли использовать `СтрокаДанных` в произвольном коде?

Да. Переменная `СтрокаДанных` содержит текущую строку из Excel-файла и позволяет обращаться к значениям колонок напрямую, если данных из маппинга недостаточно.

### Что делать, если контрагент или организация не найдены?

Убедитесь, что в базе 1С существуют элементы справочников «Контрагенты» и «Организации» с точно такими же наименованиями, как в Excel-файле. Поиск выполняется по точному совпадению наименования.


